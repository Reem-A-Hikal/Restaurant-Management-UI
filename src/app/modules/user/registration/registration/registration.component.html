<div class="mb-4">
  <h2 class="mb-4 text-center text-success">Sign Up</h2>
</div>
<form [formGroup]="registerForm" (ngSubmit)="onSubmit()" novalidate>
  <!-- Full Name -->
  <div class="mb-3">
    <div class="input-group">
      <span class="input-group-text"><i class="bi bi-person"></i></span>
      <input
        class="form-control bg-body-secondary"
        placeholder="Full Name"
        formControlName="fullName"
        [class.is-invalid]="fullName?.invalid && fullName?.touched"
        [class.is-valid]="fullName?.valid"
        type="text"
        autocomplete="name"
      />
      <div class="invalid-feedback" *ngIf="hasDisplayableError('fullName')">
        {{ getErrorMessage("fullName") }}
      </div>
    </div>
  </div>

  <!-- Email -->
  <div class="mb-3">
    <div class="input-group">
      <span class="input-group-text"><i class="bi bi-envelope-at"></i></span>
      <input
        type="email"
        class="form-control bg-body-secondary"
        placeholder="E-mail"
        formControlName="email"
        [class.is-invalid]="email?.invalid && email?.touched"
        [class.is-valid]="email?.valid"
        autocomplete="email"
      />
      <div class="invalid-feedback" *ngIf="hasDisplayableError('email')">
        {{ getErrorMessage("email") }}
      </div>
    </div>
  </div>

  <!-- Phone -->
  <div class="mb-3">
    <div class="input-group">
      <span class="input-group-text"><i class="bi bi-phone"></i></span>
      <input
        type="tel"
        class="form-control bg-body-secondary"
        placeholder="Phone Number"
        formControlName="phone"
        [class.is-invalid]="phone?.invalid && phone?.touched"
        [class.is-valid]="phone?.valid"
        autocomplete="tel"
      />
      <div class="invalid-feedback" *ngIf="hasDisplayableError('phone')">
        {{ getErrorMessage("phone") }}
      </div>
    </div>
  </div>

  <!-- Password -->
  <div class="mb-3">
    <div class="input-group">
      <span class="input-group-text"><i class="bi bi-lock"></i></span>
      <input
        [type]="showPassword ? 'text' : 'password'"
        class="form-control bg-body-secondary"
        placeholder="Password"
        formControlName="password"
        [class.is-invalid]="password?.invalid && password?.touched"
        [class.is-valid]="password?.valid"
        autocomplete="new-password"
      />
      <button
        class="btn btn-outline-secondary rounded-end-3 border"
        type="button"
        (click)="togglePasswordVisibility()"
      >
        <i [class]="showPassword ? 'bi bi-eye-slash' : 'bi bi-eye'"></i>
      </button>
    </div>

    <div class="invalid-feedback" *ngIf="hasDisplayableError('password')">
      {{ getErrorMessage("password") }}
    </div>
  </div>

  <!-- Confirm Password -->
  <div class="mb-3">
    <div class="input-group">
      <span class="input-group-text"><i class="bi bi-lock"></i></span>
      <input
        [type]="showConfirmPassword ? 'text' : 'password'"
        class="form-control bg-body-secondary"
        placeholder="Confirm Password"
        formControlName="confirmPassword"
        [class.is-invalid]="
          hasDisplayableError('confirmPassword') ||
          registerForm.hasError('passwordMismatch')
        "
        [class.is-valid]="confirmPassword?.valid"
        autocomplete="new-password"
      />
      <button
        class="btn btn-outline-secondary rounded-end-3 border"
        type="button"
        (click)="toggleConfirmPasswordVisibility()"
      >
        <i [class]="showConfirmPassword ? 'bi bi-eye-slash' : 'bi bi-eye'"></i>
      </button>
    </div>
    @if (confirmPassword?.invalid) {
    <div
      class="invalid-feedback"
      *ngIf="
        hasDisplayableError('confirmPassword') ||
        registerForm.hasError('passwordMismatch')
      "
    >
      <div *ngIf="confirmPassword?.hasError('required')">
        Please confirm your password
      </div>
      <div
        *ngIf="
          registerForm.hasError('passwordMismatch') &&
          !confirmPassword?.hasError('required')
        "
      >
        Passwords do not match
      </div>
    </div>
    }
  </div>

  <!-- Submit Button -->
  <div class="mb-3">
    <button
      type="submit"
      class="btn btn-success w-100 rounded-3 py-2"
      [disabled]="registerForm.invalid || isSubmitting"
    >
      <span *ngIf="!isSubmitting">Create Account</span>
      <span *ngIf="isSubmitting">
        <span
          class="spinner-border spinner-border-sm me-2"
          role="status"
          aria-hidden="true"
        ></span>
        Creating Account...
      </span>
    </button>
  </div>

  <!-- Login Link -->
  <div class="text-center text-muted">
    Already have an account?
    <a routerLink="/signin" class="text-success text-decoration-none"
      >Sign in</a
    >
  </div>
</form>
